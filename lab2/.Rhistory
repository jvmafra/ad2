library(tidyr)
library(dplyr)
library(ggplot2)
dados <- read.csv("dadosCEAP.csv")
limites <- read.csv("limiteMensalCEAP.csv")
agrupado_por_deputado <- dados %>% filter (valorLíquido >= 0) %>% group_by(nomeParlamentar, sgPartido, sgUF) %>%
summarise(valorTotal = sum(valorLíquido))
summary(agrupado_por_deputado$valorTotal)
boxplot(agrupado_por_deputado$valorTotal, ylab = "Valor gasto")
deputados_ordenados_decrescente <- agrupado_por_deputado[order(decreasing = TRUE, agrupado_por_deputado$valorTotal),]
deputados_ordenados_crescente <- agrupado_por_deputado[order(agrupado_por_deputado$valorTotal),]
mais_gastam <- deputados_ordenados_decrescente %>% head(10)
ggplot(data = mais_gastam, aes(x = reorder(sprintf("%s - %s/%s", nomeParlamentar, sgPartido, sgUF), valorTotal), y = valorTotal)) + geom_bar(stat = "identity", fill="steelblue") +
coord_flip() + ggtitle("15 deputados que mais gastam com CEAP") + xlab("Deputado") + ylab("Valor total gasto (em reais)")
mais_gastam <- deputados_ordenados_decrescente %>% head(10)
ggplot(data = mais_gastam, aes(x = reorder(sprintf("%s - %s/%s", nomeParlamentar, sgPartido, sgUF), valorTotal), y = valorTotal)) + geom_bar(stat = "identity", fill="steelblue") +
coord_flip() + ggtitle("15 deputados que mais gastam com CEAP") + xlab("Deputado") + ylab("Valor total gasto (em reais)")
library(tidyr)
library(dplyr)
library(ggplot2)
gastos <- read.csv("dadosCEAP.csv")
gastos_pb <- gastos %>% filter (sgUF == "PB")
gastos.atividade <- gastos_pb %>% filter(tipoDespesa == "DIVULGAÇÃO DA ATIVIDADE PARLAMENTAR.")
agrupado.fornecedor <- gastos.atividade %>% group_by(fornecedor) %>% summarise(frequencia = n())
agrupado.fornecedor.top.15 <- agrupado.fornecedor[order(decreasing = TRUE, agrupado.fornecedor$frequencia),] %>% head(15)
ggplot(data = agrupado.fornecedor.top.15, aes(x = reorder(fornecedor, frequencia), y = frequencia)) + geom_bar(stat = "identity", fill="steelblue") +
coord_flip() + ggtitle("Fornecedores do serviço de divulgação") + xlab("Fornecedor") + ylab("Numero de serviços prestados na PB")
gastos.com.mes <- gastos %>% mutate(mes = substr(dataEmissao, 1, 7))
agrupado.mes <- gastos.com.mes %>% group_by(mes) %>% summarise(valorTotal = sum(valorLíquido)) %>% na.omit()
agrupado.mes.2016 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2016") %>% mutate(mes = substr(mes, 6,7))
agrupado.mes.2015 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2015") %>% mutate(mes = substr(mes, 6,7))
ggplot(data = agrupado.mes.2016, aes(x = mes, y = valorTotal)) + geom_point(stat = "identity") + ggtitle("Gastos totais mes a mes (2016)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015, aes(x = mes, y = valorTotal)) + geom_point(stat = "identity") + geom_line() + ggtitle("Gastos totais mes a mes (2015)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015, aes(x = mes, y = valorTotal)) + geom_point(stat = "identity") + geom_line() + ggtitle("Gastos totais mes a mes (2015)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015, aes(x = mes, y = valorTotal)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2015)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015, aes(x = mes, y = valorTotal, group = 1)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2015)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2016, aes(x = mes, y = valorTotal, group = 1)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2016)") + xlab("Mes") + ylab("Valor gasto")
View(gastos)
gastos.com.mes <- gastos %>% mutate(mes = substr(dataEmissao, 1, 7)) %>% mutate(ano = substr(1,4))
gastos.com.mes <- gastos %>% mutate(mes = substr(dataEmissao, 1, 7)) %>% mutate(ano = substr(dataEmissao, 1,4))
View(gastos.com.mes)
agrupado.mes <- gastos.com.mes %>% group_by(mes, ano) %>% summarise(valorTotal = sum(valorLíquido)) %>% na.omit()
View(agrupado.mes)
agrupado.mes.2015.2016 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2016", substr(mes, 1, 4) == "2015")
View(agrupado.mes.2015.2016)
agrupado.mes.2015.2016 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2016" || substr(mes, 1, 4) == "2015")
View(agrupado.mes.2015.2016)
ggplot(data = agrupado.mes.2015.2016, aes(x = mes, y = valorTotal, group = ano)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2016)") + xlab("Mes") + ylab("Valor gasto")
agrupado.mes.2015.2016 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2016" || substr(mes, 1, 4) == "2015") %>% mutate(mes = substr(mes, 1, 4))
agrupado.mes.2015.2016 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2016" || substr(mes, 1, 4) == "2015") %>% mutate(mes_gasto = substr(mes, 1, 4))
View(agrupado.mes.2015.2016)
agrupado.mes.2015.2016 <- agrupado.mes %>% filter (substr(mes, 1, 4) == "2016" || substr(mes, 1, 4) == "2015") %>% mutate(mes_gasto = substr(mes, 6, 7))
View(agrupado.mes.2015.2016)
ggplot(data = agrupado.mes.2015.2016, aes(x = mes_gasto, y = valorTotal, group = ano)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2016)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015.2016, aes(x = mes_gasto, y = valorTotal, colour = ano, group = ano)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2016)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015.2016, aes(x = mes_gasto, y = valorTotal, colour = ano, group = ano)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2016)") + xlab("Mes") + ylab("Valor gasto")
ggplot(data = agrupado.mes.2015.2016, aes(x = mes_gasto, y = valorTotal, colour = ano, group = ano)) + geom_point() + geom_line() + ggtitle("Gastos totais mes a mes (2015 e 2016)") + xlab("Mes") + ylab("Valor gasto")
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo)
View(eleicoes2014)
eleicoes2014 %>% select(-sequencial_candidato, nome, numero_cadidato)
dados <- eleicoes2014 %>% select(-sequencial_candidato, nome, numero_cadidato)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
View(dados)
lm(votos ~ ., data = dados)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ ., data = dados)
summary(linear.model)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ UF, data = dados)
summary(linear.model)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ total_receita, data = dados)
summary(linear.model)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ total_despesa, data = dados)
summary(linear.model)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ sexo, data = dados)
summary(linear.model)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ quantidade_despesas, data = dados)
summary(linear.model)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ ., data = dados)
summary(linear.model)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo) %>% na.omit()
View(eleicoes2014)
View(eleicoes2014)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ ., data = dados)
summary(linear.model)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
View(eleicoes2014)
for(i in names(eleicoes2014)){
coluna <- eleicoes2014[i]
print mean(coluna)
for(i in names(eleicoes2014)){
coluna <- eleicoes2014[i]
print (mean(coluna))
for(i in names(eleicoes2014)){
coluna <- eleicoes2014[i]
print (mean(coluna))
}
for(i in names(eleicoes2014)){
coluna <- eleicoes2014[i]
print (coluna)
}
sapply(eleicoes2014, function(x) if("factor" %in% class(x) ) {
max(as.numeric(as.character(x)))
} else { max(x) } )
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios)
View(eleicoes2014)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
View(eleicoes2014)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ ., data = dados)
summary(linear.model)
View(eleicoes2014)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ ., data = dados)
summary(linear.model)
View(eleicoes2014)
View(eleicoes2014)
View(dados)
View(eleicoes2014)
plot(linear.model)
tidy(linear.model, conf.int = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
tidy(linear.model, conf.int = TRUE)
tidy(linear.model, conf.int = TRUE)
library(tidyr)
library(GGally)
install.packages("GGally")
install.packages("broom")
library(GGally)
library(broom)
tidy(linear.model, conf.int = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
library(GGally)
library(broom)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
View(eleicoes2014)
View(eleicoes2014)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
linear.model <- lm(votos ~ ., data = dados)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
linear.model <- lm(votos ~ ., data = eleicoes2014)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
linear.model <- lm(votos ~ ., data = eleicoes2014)
summary(linear.model)
View(eleicoes2014)
View(eleicoes2014)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo, -setor_economico_receita)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo, -setor_economico_receita)
linear.model <- lm(votos ~ ., data = eleicoes2014)
summary(linear.model)
eleicoes2014.filtered <- eleicoes2014 %>% select(-recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
linear.model <- lm(votos ~ ., data = eleicoes2014)
eleicoes2014.filtered <- eleicoes2014 %>% select(-recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
summary(linear.model.filtered)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
library(GGally)
library(broom)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1")
eleicoes2014 <- eleicoes2014 %>% select(-cargo, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
dados <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato)
linear.model <- lm(votos ~ ., data = dados)
summary(linear.model)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
linear.model <- lm(votos ~ ., data = eleicoes2014)
summary(linear.model)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
eleicoes2014.filtered <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
summary(linear.model.filtered)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
summary(linear.model.filtered)
plot(linear.model.filtered)
summary(linear.model.filtered)$r.squared
help("summary.lm")
summary(linear.model.filtered)$adj.r.squared
summary(linear.model.filtered)$correlation
summary(linear.model.filtered)$fstatistic
summary(linear.model.filtered)$residuals
summary(linear.model.filtered)$coefficients[,4]
pVal <- anova(linear.model.filtered)$'Pr(>F)'[1]
pVal
summary(linear.model.filtered)
plot(linear.model.filtered)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$media_receita)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$quantidade_despesas)
cor(eleicoes2014.filtered$media_receita, eleicoes2014.filtered$quantidade_despesas)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$quantidade_despesas)
cor(eleicoes2014.filtered$quantidade_doacoes, eleicoes2014.filtered$quantidade_doadores)
cor(eleicoes2014.filtered$quantidade_doadores, eleicoes2014.filtered$total_despesa)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$quantidade_despesas)
cor(eleicoes2014.filtered$total_despesa, eleicoes2014.filtered$media_despesa)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$media_despesa)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$media_despesa)
cor(eleicoes2014.filtered$total_receita, eleicoes2014.filtered$quantidade_despesas)
cor(eleicoes2014.filtered$quantidade_doadores, eleicoes2014.filtered$total_despesa)
cor(eleicoes2014.filtered$quantidade_doadores, eleicoes2014.filtered$total_receita)
eleicoes2014.filtered.variables <- eleicoes2014.filtered %>% select(media_despesa, votos, quantidade_doacoes, total_receita)
linear.model2 <- lm(votos ~ ., data = eleicoes2014.filtered.variables)
summary(linear.model2)
library(corrgram)
install.packages("corrgram")
library(corrgram)
library(corrgram)
summary(linear.model.filtered)
eleicoes2014.filtered.variables <- eleicoes2014.filtered %>% select(quantidade_doacoes, quantidade_doadores, total_receita, media_receita, quantidade_despesas, quantidade_fornecedores, total_despesa, media_despesa, sexo)
ggpairs(eleicoes2014)
ggpairs(eleicoes2014.filtered.variables)
View(eleicoes2014.filtered.variables)
eleicoes2014.filtered.variables <- eleicoes2014.filtered %>% select(quantidade_doacoes, quantidade_doadores, total_receita, media_receita, quantidade_despesas, quantidade_fornecedores, total_despesa, media_despesa, sexo, voto)
eleicoes2014.filtered.variables <- eleicoes2014.filtered %>% select(quantidade_doacoes, quantidade_doadores, total_receita, media_receita, quantidade_despesas, quantidade_fornecedores, total_despesa, media_despesa, votos)
View(eleicoes2014.filtered.variables)
names(eleicoes2014.filtered.variables) <- c("quant_doacoes", "quant_doadores", "total_rec", "media_rec", "quant_desp", "quant_forn", "total_desp", "media_desp", "votos")
View(eleicoes2014.filtered.variables)
ggpairs(eleicoes2014.filtered.variables)
new.df <- eleicoes2014.filtered.variables %>% select(quant_doadores, total_desp, media_rec, votos)
linear.model2 <- lm(votos ~ ., data = new.df)
summary(linear.model2)
ggpairs(eleicoes2014.filtered.variables)
new.df <- eleicoes2014.filtered.variables %>% select(quant_doacoes, total_desp, media_rec, votos)
new.df <- eleicoes2014.filtered.variables %>% select(quant_doadores, quant_doacoes, total_desp, media_rec, votos)
linear.model2 <- lm(votos ~ ., data = new.df)
summary(linear.model2)
new.df <- eleicoes2014.filtered.variables %>% select(total_desp, media_rec, votos)
linear.model2 <- lm(votos ~ ., data = new.df)
summary(linear.model2)
ggpairs(eleicoes2014.filtered.variables)
new.df <- eleicoes2014.filtered.variables %>% select(quant_doadores, total_desp, total_rec, media_rec, votos)
linear.model2 <- lm(votos ~ ., data = new.df)
summary(linear.model2)
eleicoes2014.filtered <- eleicoes2014 %>% select( recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
linear.model <- lm(votos ~ ., data = eleicoes2014)
eleicoes2014.filtered <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
View(eleicoes2014.filtered)
eleicoes2014.filtered <- eleicoes2014 %>% select(-recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
View(eleicoes2014.filtered)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
summary(linear.model.filtered)
eleicoes2014.filtered <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
linear.model.filtered <- lm(votos ~ ., data = eleicoes2014.filtered)
summary(linear.model.filtered)
tidy(linear.model.filtered, conf.int = TRUE)
plot(linear.model.filtered)
glance(linear.model.filtered)
glance(linear.model2)
plot(linear.model2)
plot(eleicoes2014.filtered.variables$votos, model.res)
model.res <- resid(linear.model2)
plot(eleicoes2014.filtered.variables$votos, model.res)
plot(model.res)
plot(linear.model2)
ggpairs(eleicoes2014.filtered.variables)
new.df <- eleicoes2014.filtered.variables %>% select(quant_doadores, total_desp, media_rec, votos)
linear.model2 <- lm(votos ~ ., data = new.df)
summary(linear.model2)
glance(linear.model2)
plot(linear.model2)
summary(linear.model.filtered)
mse <- mean(residuals(model.res)^2)
mse <- mean(residuals(model.res)^2)
mse <- mean(residuals(linear.model2)^2)
rmse <- sqrt(mse)
rss <- sum(residuals(linear.model2)^2)
rse <- sqrt(rss/ linear.model$df.residual )
rse
mse <- mean(residuals(linear.model2)^2)
rmse <- sqrt(mse)
rss <- sum(residuals(linear.model2)^2)
rse <- sqrt(sum(residuals(linear.model2)^2)/linear.model$df.residual)
rse
summary(linear.model2)
s <- summary(linear.model2)
s$sigma
glance(linear.model2)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
library(GGally)
library(broom)
library(olsrr)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
filtered.variables <- eleicoes2014.filtered %>% select(total_receita, quantidade_doadores, media_receita, quantidade_despesas, quantidade_fornecedores, media_despesa, total_despesa, quantidade_doacoes)
eleicoes2014.filtered <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
filtered.variables <- eleicoes2014.filtered %>% select(total_receita, quantidade_doadores, media_receita, quantidade_despesas, quantidade_fornecedores, media_despesa, total_despesa, quantidade_doacoes)
names(filtered.variables) <- c("tot_rec", "quant_doad", "med_rec", "quant_desp", "quant_forn", "med_desp", "tot_desp", "quant_doac")
ggpairs(filtered.variables)
library(olsrr)
library(olsrr)
ggcorr(filtered.variables, hjust = 0.80, vjust=1.5, size = 3, label = TRUE, var.position = 'diagonal', lower = TRUE)
names(filtered.variables) <- c("tot_receita", "quant_doadores", "med_receita", "quant_despesa", "quant_forn", "med_despesa", "tot_despesa", "quant_doacoes")
ggcorr(filtered.variables, hjust = 0.80, vjust=1.5, size = 3, label = TRUE, var.position = 'diagonal', lower = TRUE)
names(filtered.variables) <- c("tot_receita", "quant_doadores", "med_receita", "quant_despesa", "quant_forn", "med_despesa", "tot_despesa", "quant_doacoes")
ggcorr(filtered.variables, hjust = 0.80, vjust=1.5, size = 3, label = TRUE, var.position = 'diagonal', lower = TRUE)
names(filtered.variables) <- c("tot_rec", "quant_doadores", "med_receita", "quant_despesa", "quant_forn", "med_despesa", "tot_despesa", "quant_doacoes")
ggcorr(filtered.variables, hjust = 0.80, vjust=1.5, size = 3, label = TRUE, var.position = 'diagonal', lower = TRUE)
boxplot(eleicoes2014$votos)
install.packages("caret")
setwd("~/workspace/ad2/lab2")
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
library(caret)
eleicoes2014 <- read.csv("~/workspace/ad2/lab2/eleicoes2014.csv", encoding = "latin1") %>% select(-cargo)
View(eleicoes2014)
eleicoes2014.filtered <- eleicoes2014 %>% select(-sequencial_candidato, -nome, -numero_cadidato, -recursos_de_outros_candidatos.comites, -recursos_de_partidos, -recursos_de_pessoas_físicas, -recursos_de_pessoas_juridicas, -recursos_proprios, -setor_economico_receita, -setor_economico_despesa)
View(eleicoes2014.filtered)
View(eleicoes2014.filtered)
fitControl <- trainControl(method = "cv",
number = 10,
repeats = 10)
ridge.model.cv <- train(votos ~ .,
data = eleicoes2014.filtered,
method = "ridge",
trControl = fitControl)
ridge.model.cv <- train(votos ~ .,
data = eleicoes2014.filtered,
method = "ridge",
trControl = fitControl)
ridge.model.cv
fitControl <- trainControl(method = "cv",
number = 10,
repeats = 10)
fitControl <- trainControl(method = "repeatedcv",
number = 10,
repeats = 10)
ridge.model.cv <- train(votos ~ .,
data = eleicoes2014.filtered,
method = "ridge",
trControl = fitControl)
ridge.model.cv
fitControl <- trainControl(method = "repeatedcv",
number = 5,
repeats = 5)
ridge.model.cv <- train(votos ~ .,
data = eleicoes2014.filtered,
method = "ridge",
trControl = fitControl,
preProcess = c('scale', 'center'))
ridge.model.cv
fitControl <- trainControl(method = "repeatedcv",
number = 5,
repeats = 5,
search = "random")
ridge.model.cv <- train(votos ~ .,
data = eleicoes2014.filtered,
method = "ridge",
trControl = fitControl,
preProcess = c('scale', 'center'))
ridge.model.cv
lambdaGrid <- expand.grid(lambda = 10^seq(10, -2, length=100))
fitControl <- trainControl(method = "repeatedcv",
number = 5,
repeats = 5,
search = "grid")
ridge.model.cv <- train(votos ~ .,
data = eleicoes2014.filtered,
method = "ridge",
trControl = fitControl,
tuneGrid = lambdaGrid,
preProcess = c('scale', 'center'))
